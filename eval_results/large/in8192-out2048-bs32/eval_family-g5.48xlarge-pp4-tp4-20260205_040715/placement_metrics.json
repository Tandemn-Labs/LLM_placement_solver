{
  "config": {
    "model_name": "llama3-70b",
    "num_decoder_layers": 80,
    "sequence_length": 8192,
    "output_length": 2048,
    "min_batch_size": 32,
    "max_batch_size": 32,
    "optimal_batch_size": 32,
    "d_model": 8192,
    "d_hidden": 28672,
    "max_pipeline_stages": 8,
    "min_memory_utilization": 0.1
  },
  "solution": {
    "objective_value": 0.0,
    "batch_size": 32,
    "throughput_tokens_per_sec": 225.45719061458527,
    "raw_throughput_tokens_per_sec": 1461.2966058352752,
    "pipeline_efficiency": 0.5142857142857142,
    "cost_per_hour": 65.16,
    "cost_per_token": 8.028131615878067e-05,
    "total_runtime_hours": 1.2320643977713424,
    "meets_cost_threshold": true,
    "tp_configuration": {
      "g5.48xlarge#0": 4,
      "g5.48xlarge#1": 4,
      "g5.48xlarge#2": 4,
      "g5.48xlarge#3": 4
    },
    "gpu_assignments": [
      {
        "gpu_type": "g5.48xlarge#0",
        "partition_id": 0,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          100,
          101,
          102,
          103
        ],
        "tp_degree": 4,
        "start_layer": 1,
        "end_layer": 20,
        "segment_size": 20,
        "throughput": 1461.2966058352752
      },
      {
        "gpu_type": "g5.48xlarge#1",
        "partition_id": 1,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          108,
          109,
          110,
          111
        ],
        "tp_degree": 4,
        "start_layer": 21,
        "end_layer": 40,
        "segment_size": 20,
        "throughput": 1461.2966058352752
      },
      {
        "gpu_type": "g5.48xlarge#2",
        "partition_id": 2,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          116,
          117,
          118,
          119
        ],
        "tp_degree": 4,
        "start_layer": 41,
        "end_layer": 60,
        "segment_size": 20,
        "throughput": 1461.2966058352752
      },
      {
        "gpu_type": "g5.48xlarge#3",
        "partition_id": 3,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          124,
          125,
          126,
          127
        ],
        "tp_degree": 4,
        "start_layer": 61,
        "end_layer": 80,
        "segment_size": 20,
        "throughput": 1461.2966058352752
      }
    ],
    "network_connections": [
      {
        "from_segment": {
          "gpu_type": "g5.48xlarge#0",
          "partition_id": 0,
          "start_layer": 1,
          "end_layer": 20
        },
        "to_segment": {
          "gpu_type": "g5.48xlarge#1",
          "partition_id": 1,
          "start_layer": 21,
          "end_layer": 40
        },
        "throughput": 204800.0
      },
      {
        "from_segment": {
          "gpu_type": "g5.48xlarge#1",
          "partition_id": 1,
          "start_layer": 21,
          "end_layer": 40
        },
        "to_segment": {
          "gpu_type": "g5.48xlarge#2",
          "partition_id": 2,
          "start_layer": 41,
          "end_layer": 60
        },
        "throughput": 204800.0
      },
      {
        "from_segment": {
          "gpu_type": "g5.48xlarge#2",
          "partition_id": 2,
          "start_layer": 41,
          "end_layer": 60
        },
        "to_segment": {
          "gpu_type": "g5.48xlarge#3",
          "partition_id": 3,
          "start_layer": 61,
          "end_layer": 80
        },
        "throughput": 204800.0
      }
    ],
    "solve_status": null,
    "num_pipeline_stages": 4
  }
}