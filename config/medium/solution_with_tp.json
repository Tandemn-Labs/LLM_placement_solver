{
  "config": {
    "model_name": "llama-70b",
    "num_decoder_layers": 40,
    "sequence_length": 4096,
    "batch_size": 32,
    "d_model": 8192,
    "d_hidden": 22016,
    "max_pipeline_stages": 8,
    "min_memory_utilization": 0.5
  },
  "solution": {
    "objective_value": 8344.650268554688,
    "throughput_tokens_per_sec": 8344.650268554688,
    "cost_per_hour": 5.6,
    "cost_per_token": 1.864135111111111e-07,
    "meets_cost_threshold": true,
    "tp_configuration": {
      "A100": 8,
      "L20": 8,
      "A10": 8,
      "V100": 8,
      "T4": 8
    },
    "gpu_assignments": [
      {
        "gpu_type": "V100",
        "partition_id": 12,
        "gpu_ids": [
          0,
          1
        ],
        "global_gpu_ids": [
          32,
          33
        ],
        "tp_degree": 2,
        "start_layer": 1,
        "end_layer": 5,
        "segment_size": 5,
        "throughput": 14184.759213374213
      },
      {
        "gpu_type": "V100",
        "partition_id": 14,
        "gpu_ids": [
          4,
          5
        ],
        "global_gpu_ids": [
          36,
          37
        ],
        "tp_degree": 2,
        "start_layer": 6,
        "end_layer": 10,
        "segment_size": 5,
        "throughput": 14184.759213374213
      },
      {
        "gpu_type": "V100",
        "partition_id": 16,
        "gpu_ids": [
          8,
          9
        ],
        "global_gpu_ids": [
          40,
          41
        ],
        "tp_degree": 2,
        "start_layer": 11,
        "end_layer": 15,
        "segment_size": 5,
        "throughput": 14184.759213374213
      },
      {
        "gpu_type": "V100",
        "partition_id": 13,
        "gpu_ids": [
          2,
          3
        ],
        "global_gpu_ids": [
          34,
          35
        ],
        "tp_degree": 2,
        "start_layer": 16,
        "end_layer": 20,
        "segment_size": 5,
        "throughput": 14184.759213374213
      },
      {
        "gpu_type": "A100",
        "partition_id": 1,
        "gpu_ids": [
          1
        ],
        "global_gpu_ids": [
          1
        ],
        "tp_degree": 1,
        "start_layer": 21,
        "end_layer": 25,
        "segment_size": 5,
        "throughput": 21457.672119140625
      },
      {
        "gpu_type": "V100",
        "partition_id": 17,
        "gpu_ids": [
          10,
          11
        ],
        "global_gpu_ids": [
          42,
          43
        ],
        "tp_degree": 2,
        "start_layer": 26,
        "end_layer": 30,
        "segment_size": 5,
        "throughput": 14184.759213374213
      },
      {
        "gpu_type": "A100",
        "partition_id": 0,
        "gpu_ids": [
          0
        ],
        "global_gpu_ids": [
          0
        ],
        "tp_degree": 1,
        "start_layer": 31,
        "end_layer": 35,
        "segment_size": 5,
        "throughput": 21457.672119140625
      },
      {
        "gpu_type": "V100",
        "partition_id": 15,
        "gpu_ids": [
          6,
          7
        ],
        "global_gpu_ids": [
          38,
          39
        ],
        "tp_degree": 2,
        "start_layer": 36,
        "end_layer": 40,
        "segment_size": 5,
        "throughput": 14184.759213374213
      }
    ],
    "network_connections": [
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 12,
          "start_layer": 1,
          "end_layer": 5
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 14,
          "start_layer": 6,
          "end_layer": 10
        },
        "throughput": 18022400.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 14,
          "start_layer": 6,
          "end_layer": 10
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 16,
          "start_layer": 11,
          "end_layer": 15
        },
        "throughput": 19660800.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 16,
          "start_layer": 11,
          "end_layer": 15
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 13,
          "start_layer": 16,
          "end_layer": 20
        },
        "throughput": 19660800.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 13,
          "start_layer": 16,
          "end_layer": 20
        },
        "to_segment": {
          "gpu_type": "A100",
          "partition_id": 1,
          "start_layer": 21,
          "end_layer": 25
        },
        "throughput": 19660800.0
      },
      {
        "from_segment": {
          "gpu_type": "A100",
          "partition_id": 1,
          "start_layer": 21,
          "end_layer": 25
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 17,
          "start_layer": 26,
          "end_layer": 30
        },
        "throughput": 19660800.0
      },
      {
        "from_segment": {
          "gpu_type": "V100",
          "partition_id": 17,
          "start_layer": 26,
          "end_layer": 30
        },
        "to_segment": {
          "gpu_type": "A100",
          "partition_id": 0,
          "start_layer": 31,
          "end_layer": 35
        },
        "throughput": 19660800.0
      },
      {
        "from_segment": {
          "gpu_type": "A100",
          "partition_id": 0,
          "start_layer": 31,
          "end_layer": 35
        },
        "to_segment": {
          "gpu_type": "V100",
          "partition_id": 15,
          "start_layer": 36,
          "end_layer": 40
        },
        "throughput": 19660800.0
      }
    ],
    "solve_status": 2,
    "num_pipeline_stages": 8
  }
}