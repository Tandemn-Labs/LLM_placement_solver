{
  "config": {
    "model_name": "llama3-70b-decode",
    "num_decoder_layers": 80,
    "sequence_length": 8192,
    "min_batch_size": 64,
    "max_batch_size": 64,
    "optimal_batch_size": 64,
    "d_model": 8192,
    "d_hidden": 28672,
    "max_pipeline_stages": 8,
    "min_memory_utilization": 0.5
  },
  "solution": {
    "objective_value": 18452.009940988813,
    "batch_size": 64,
    "throughput_tokens_per_sec": 3321.361789377986,
    "cost_per_hour": 68.48,
    "cost_per_token": 5.727235823287003e-06,
    "total_runtime_hours": 0.08363370069052281,
    "meets_cost_threshold": true,
    "tp_configuration": {
      "p4de.24xlarge#0": 8,
      "p3dn.24xlarge#0": 8,
      "p3dn.24xlarge#1": 8,
      "p3dn.24xlarge#2": 8,
      "p3dn.24xlarge#3": 8,
      "g6e.48xlarge#0": 8,
      "g6e.48xlarge#1": 8,
      "g6e.48xlarge#2": 8,
      "g6e.48xlarge#3": 8,
      "g6e.24xlarge#0": 4,
      "g6e.24xlarge#1": 4,
      "g6e.24xlarge#2": 4,
      "g6e.24xlarge#3": 4,
      "g6e.12xlarge#0": 2,
      "g6e.12xlarge#1": 2,
      "g6e.12xlarge#2": 2,
      "g6e.12xlarge#3": 2,
      "g6e.4xlarge#0": 1,
      "g6e.4xlarge#1": 1,
      "g6e.4xlarge#2": 1,
      "g6e.4xlarge#3": 1,
      "g5.48xlarge#0": 8,
      "g5.48xlarge#1": 8,
      "g5.48xlarge#2": 8,
      "g5.48xlarge#3": 8,
      "g5.24xlarge#0": 4,
      "g5.24xlarge#1": 4,
      "g5.24xlarge#2": 4,
      "g5.24xlarge#3": 4,
      "g5.12xlarge#0": 4,
      "g5.12xlarge#1": 4,
      "g5.12xlarge#2": 4,
      "g5.12xlarge#3": 4,
      "g5.4xlarge#0": 1,
      "g5.4xlarge#1": 1,
      "g5.4xlarge#2": 1,
      "g5.4xlarge#3": 1
    },
    "gpu_assignments": [
      {
        "gpu_type": "g6e.48xlarge#2",
        "partition_id": 12,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          56,
          57,
          58,
          59
        ],
        "tp_degree": 4,
        "start_layer": 1,
        "end_layer": 16,
        "segment_size": 16,
        "throughput": 18452.009940988813
      },
      {
        "gpu_type": "g6e.48xlarge#3",
        "partition_id": 13,
        "gpu_ids": [
          4,
          5,
          6,
          7
        ],
        "global_gpu_ids": [
          68,
          69,
          70,
          71
        ],
        "tp_degree": 4,
        "start_layer": 17,
        "end_layer": 32,
        "segment_size": 16,
        "throughput": 18452.009940988813
      },
      {
        "gpu_type": "g6e.48xlarge#3",
        "partition_id": 12,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          64,
          65,
          66,
          67
        ],
        "tp_degree": 4,
        "start_layer": 33,
        "end_layer": 48,
        "segment_size": 16,
        "throughput": 18452.009940988813
      },
      {
        "gpu_type": "g6e.48xlarge#2",
        "partition_id": 13,
        "gpu_ids": [
          4,
          5,
          6,
          7
        ],
        "global_gpu_ids": [
          60,
          61,
          62,
          63
        ],
        "tp_degree": 4,
        "start_layer": 49,
        "end_layer": 64,
        "segment_size": 16,
        "throughput": 18452.009940988813
      },
      {
        "gpu_type": "g6e.24xlarge#1",
        "partition_id": 6,
        "gpu_ids": [
          0,
          1,
          2,
          3
        ],
        "global_gpu_ids": [
          76,
          77,
          78,
          79
        ],
        "tp_degree": 4,
        "start_layer": 65,
        "end_layer": 80,
        "segment_size": 16,
        "throughput": 18452.009940988813
      }
    ],
    "network_connections": [
      {
        "from_segment": {
          "gpu_type": "g6e.48xlarge#2",
          "partition_id": 12,
          "start_layer": 1,
          "end_layer": 16
        },
        "to_segment": {
          "gpu_type": "g6e.48xlarge#3",
          "partition_id": 13,
          "start_layer": 17,
          "end_layer": 32
        },
        "throughput": 409600.0
      },
      {
        "from_segment": {
          "gpu_type": "g6e.48xlarge#3",
          "partition_id": 13,
          "start_layer": 17,
          "end_layer": 32
        },
        "to_segment": {
          "gpu_type": "g6e.48xlarge#3",
          "partition_id": 12,
          "start_layer": 33,
          "end_layer": 48
        },
        "throughput": 1572864.0
      },
      {
        "from_segment": {
          "gpu_type": "g6e.48xlarge#3",
          "partition_id": 12,
          "start_layer": 33,
          "end_layer": 48
        },
        "to_segment": {
          "gpu_type": "g6e.48xlarge#2",
          "partition_id": 13,
          "start_layer": 49,
          "end_layer": 64
        },
        "throughput": 409600.0
      },
      {
        "from_segment": {
          "gpu_type": "g6e.48xlarge#2",
          "partition_id": 13,
          "start_layer": 49,
          "end_layer": 64
        },
        "to_segment": {
          "gpu_type": "g6e.24xlarge#1",
          "partition_id": 6,
          "start_layer": 65,
          "end_layer": 80
        },
        "throughput": 409600.0
      }
    ],
    "solve_status": 2,
    "num_pipeline_stages": 5
  }
}